% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_gbrs_genome}
\alias{plot_gbrs_genome}
\title{Main function to create GBRS genome plots}
\usage{
plot_gbrs_genome(
  npz_file,
  founders = DEFAULT_FOUNDERS,
  founder_colors = DEFAULT_FOUNDER_COLORS,
  chrom_lengths = DEFAULT_CHROM_LENGTHS,
  config = DEFAULT_CONFIG,
  sample_name = NULL,
  return_data = FALSE
)
}
\arguments{
\item{npz_file}{Path to NPZ file containing genotypic probability data}

\item{founders}{Character vector of founder strain names (default: DEFAULT_FOUNDERS)}

\item{founder_colors}{Named vector of founder colors (default: DEFAULT_FOUNDER_COLORS)}

\item{chrom_lengths}{Named vector of chromosome lengths for ordering (default: DEFAULT_CHROM_LENGTHS)}

\item{config}{Configuration list (default: DEFAULT_CONFIG)}

\item{sample_name}{Sample name for plot title (default: extracted from filename)}

\item{return_data}{Logical, whether to return processed data along with plot (default: FALSE)}
}
\value{
Either a ggplot object (default) or a list containing:
\itemize{
  \item{plot}{The generated genome plot}
  \item{data}{Processed genotype data}
  \item{data_long}{Long-format data for plotting}
  \item{recombinations}{Recombination count data}
  \item{config}{Configuration used}
}
}
\description{
This is the main function for creating genome reconstruction plots from NPZ files.
It orchestrates the entire workflow from data loading to final plot generation,
providing a simple interface for users while maintaining flexibility.
}
\details{
This function performs a complete workflow:
\itemize{
  \item{Loads and validates NPZ file data}
  \item{Processes genotype probabilities into founder assignments}
  \item{Counts recombination events per chromosome}
  \item{Generates publication-quality plots with automatic internal processing}
  \item{Provides comprehensive progress reporting}
}
}
\section{CRITICAL DEPENDENCY WARNING}{

This function REQUIRES the reticulate R package and Python with NumPy installed.
Without these dependencies, the function will fail with errors like:
- 'Error: Please install reticulate'
- 'FileNotFoundError: No such file or directory'

See the README for complete installation instructions.
}

\examples{
\dontrun{
# Basic usage
plot <- plot_gbrs_genome('example.npz')

# With custom configuration
config <- configure_plot(compact_mode = TRUE, bar_height = 0.3)
plot <- plot_gbrs_genome('example.npz', config = config)

# With custom chromosome ordering
custom_chroms <- c('1' = 1000000, '2' = 2000000, 'X' = 1500000)
plot <- plot_gbrs_genome('example.npz', chrom_lengths = custom_chroms)

# Return both plot and data
result <- plot_gbrs_genome('example.npz', return_data = TRUE)
plot <- result$plot
data <- result$data
}

}
